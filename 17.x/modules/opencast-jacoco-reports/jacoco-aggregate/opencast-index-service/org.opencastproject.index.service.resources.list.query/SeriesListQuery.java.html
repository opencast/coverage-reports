<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>SeriesListQuery.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-index-service</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.index.service.resources.list.query</a> &gt; <span class="el_source">SeriesListQuery.java</span></div><h1>SeriesListQuery.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */

package org.opencastproject.index.service.resources.list.query;

import org.opencastproject.index.service.resources.list.provider.AclListProvider;
import org.opencastproject.index.service.resources.list.provider.ContributorsListProvider;
import org.opencastproject.index.service.resources.list.provider.SeriesListProvider;
import org.opencastproject.index.service.util.FiltersUtils;
import org.opencastproject.list.api.ResourceListFilter;
import org.opencastproject.list.api.ResourceListFilter.SourceType;
import org.opencastproject.list.impl.ResourceListQueryImpl;
import org.opencastproject.util.data.Option;
import org.opencastproject.util.data.Tuple;

import java.util.Date;

/**
 * Query for the series list.
 *
 * The following filters can be used:
 * &lt;ul&gt;
 * &lt;li&gt;contributors&lt;/li&gt;
 * &lt;li&gt;subject&lt;/li&gt;
 * &lt;li&gt;language&lt;/li&gt;
 * &lt;li&gt;creator&lt;/li&gt;
 * &lt;li&gt;license&lt;/li&gt;
 * &lt;li&gt;access policy&lt;/li&gt;
 * &lt;li&gt;creation date&lt;/li&gt;
 * &lt;/ul&gt;
 */
public class SeriesListQuery extends ResourceListQueryImpl {

  public static final String FILTER_ACL_NAME = &quot;managedAcl&quot;;
  private static final String FILTER_ACL_LABEL = &quot;FILTERS.SERIES.ACCESS_POLICY.LABEL&quot;;

  public static final String FILTER_ACL_PERMISSION_READ_NAME = &quot;acl_permission_read&quot;;
  private static final String FILTER_ACL_PERMISSION_READ_LABEL = &quot;FILTERS.SERIES.ACL_PREMISSION_READ.LABEL&quot;;

  public static final String FILTER_ACL_PERMISSION_WRITE_NAME = &quot;acl_permission_write&quot;;
  private static final String FILTER_ACL_PERMISSION_WRITE_LABEL = &quot;FILTERS.SERIES.ACL_PREMISSION_WRITE.LABEL&quot;;

  public static final String FILTER_CONTRIBUTORS_NAME = &quot;contributors&quot;;
  private static final String FILTER_CONTRIBUTORS_LABEL = &quot;FILTERS.SERIES.CONTRIBUTORS.LABEL&quot;;

  public static final String FILTER_CREATIONDATE_NAME = &quot;CreationDate&quot;;
  private static final String FILTER_CREATIONDATE_LABEL = &quot;FILTERS.SERIES.CREATION_DATE.LABEL&quot;;

  public static final String FILTER_CREATOR_NAME = &quot;Creator&quot;;
  private static final String FILTER_CREATOR_LABEL = &quot;FILTERS.SERIES.CREATOR.LABEL&quot;;

  public static final String FILTER_TEXT_NAME = &quot;textFilter&quot;;

  public static final String FILTER_LANGUAGE_NAME = &quot;language&quot;;
  private static final String FILTER_LANGUAGE_LABEL = &quot;FILTERS.SERIES.LANGUAGE.LABEL&quot;;

  public static final String FILTER_LICENSE_NAME = &quot;license&quot;;
  private static final String FILTER_LICENSE_LABEL = &quot;FILTERS.SERIES.LICENSE.LABEL&quot;;

  public static final String FILTER_ORGANIZERS_NAME = &quot;organizers&quot;;
  private static final String FILTER_ORGANIZERS_LABEL = &quot;FILTERS.SERIES.ORGANIZERS.LABEL&quot;;

  public static final String FILTER_SUBJECT_NAME = &quot;subject&quot;;
  private static final String FILTER_SUBJECT_LABEL = &quot;FILTERS.SERIES.SUBJECT.LABEL&quot;;

  public static final String FILTER_TITLE_NAME = &quot;title&quot;;
  private static final String FILTER_TITLE_LABEL = &quot;FILTERS.SERIES.TITLE.LABEL&quot;;

  public SeriesListQuery() {
<span class="nc" id="L88">    super();</span>
<span class="nc" id="L89">    this.availableFilters.add(createCreationDateFilter(Option.&lt;Tuple&lt;Date, Date&gt;&gt; none()));</span>
<span class="nc" id="L90">    this.availableFilters.add(createOrganizersFilter(Option.none()));</span>
<span class="nc" id="L91">    this.availableFilters.add(createContributorsFilter(Option.none()));</span>
<span class="nc" id="L92">  }</span>

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given acl
   *
   * @param acl
   *          the acl to filter for
   */
  public void withAccessPolicy(String acl) {
<span class="nc" id="L101">    this.addFilter(createAccessPolicyFilter(Option.option(acl)));</span>
<span class="nc" id="L102">  }</span>

  /**
   * Returns an {@link Option} containing the acl used to filter if set
   *
   * @return an {@link Option} containing the acl or none.
   */
  public Option&lt;String&gt; getAccessPolicy() {
<span class="nc" id="L110">    return this.getFilterValue(FILTER_ACL_NAME);</span>
  }

  public void withoutPermissions() {
<span class="nc" id="L114">    ResourceListFilter filter = this.getFilter(FILTER_ACL_PERMISSION_READ_NAME);</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">    if (filter != null) {</span>
<span class="nc" id="L116">      this.removeFilter(filter);</span>
    }
<span class="nc" id="L118">    filter = this.getFilter(FILTER_ACL_PERMISSION_WRITE_NAME);</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">    if (filter != null) {</span>
<span class="nc" id="L120">      this.removeFilter(filter);</span>
    }
<span class="nc" id="L122">  }</span>

  public void withReadPermission(boolean value) {
<span class="nc" id="L125">    this.addFilter(createReadPermissionFilter(Option.option(value)));</span>
<span class="nc" id="L126">  }</span>

  public void withWritePermission(boolean value) {
<span class="nc" id="L129">    this.addFilter(createWritePermissionFilter(Option.option(value)));</span>
<span class="nc" id="L130">  }</span>

  public Option&lt;Boolean&gt; getReadPermission() {
<span class="nc" id="L133">    return this.getFilterValue(FILTER_ACL_PERMISSION_READ_NAME);</span>
  }

  public Option&lt;Boolean&gt; getWritePermission() {
<span class="nc" id="L137">    return this.getFilterValue(FILTER_ACL_PERMISSION_WRITE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given contributor
   *
   * @param contributor
   *          the contributor to filter for
   */
  public void withContributor(String contributor) {
<span class="nc" id="L147">    this.addFilter(createContributorsFilter(Option.option(contributor)));</span>
<span class="nc" id="L148">  }</span>

  /**
   * Returns an {@link Option} containing the contributor used to filter if set
   *
   * @return an {@link Option} containing the contributor or none.
   */
  public Option&lt;String&gt; getContributor() {
<span class="nc" id="L156">    return this.getFilterValue(FILTER_CONTRIBUTORS_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given creation date period
   *
   * @param creationDate
   *          the creation date period as {@link Tuple} with two {@link Date}.
   */
  public void withCreationDate(Tuple&lt;Date, Date&gt; creationDate) {
<span class="nc" id="L166">    this.addFilter(createCreationDateFilter(Option.option(creationDate)));</span>
<span class="nc" id="L167">  }</span>

  /**
   * Returns an {@link Option} containing the creation date period used to filter if set
   *
   * @return an {@link Option} containing the creation date period or none.
   */
  public Option&lt;Tuple&lt;Date, Date&gt;&gt; getCreationDate() {
<span class="nc" id="L175">    return this.getFilterValue(FILTER_CREATIONDATE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given creator
   *
   * @param creator
   *          the creator to filter for
   */
  public void withCreator(String creator) {
<span class="nc" id="L185">    this.addFilter(createCreatorFilter(Option.option(creator)));</span>
<span class="nc" id="L186">  }</span>

  /**
   * Returns an {@link Option} containing the creator used to filter if set
   *
   * @return an {@link Option} containing the creator or none.
   */
  public Option&lt;String&gt; getCreator() {
<span class="nc" id="L194">    return this.getFilterValue(FILTER_CREATOR_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given language
   *
   * @param language
   *          the language to filter for
   */
  public void withLanguage(String language) {
<span class="nc" id="L204">    this.addFilter(createLanguageFilter(Option.option(language)));</span>
<span class="nc" id="L205">  }</span>

  /**
   * Returns an {@link Option} containing the language used to filter if set
   *
   * @return an {@link Option} containing the language or none.
   */
  public Option&lt;String&gt; getLanguage() {
<span class="nc" id="L213">    return this.getFilterValue(FILTER_LANGUAGE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given license
   *
   * @param license
   *          the license to filter for
   */
  public void withLicense(String license) {
<span class="nc" id="L223">    this.addFilter(createLicenseFilter(Option.option(license)));</span>
<span class="nc" id="L224">  }</span>

  /**
   * Returns an {@link Option} containing the license used to filter if set
   *
   * @return an {@link Option} containing the license or none.
   */
  public Option&lt;String&gt; getLicense() {
<span class="nc" id="L232">    return this.getFilterValue(FILTER_LICENSE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given organizer
   *
   * @param organizer
   *          the organizer to filter for
   */
  public void withOrganizer(String organizer) {
<span class="nc" id="L242">    this.addFilter(createOrganizersFilter(Option.option(organizer)));</span>
<span class="nc" id="L243">  }</span>

  /**
   * Returns an {@link Option} containing the organizer used to filter if set
   *
   * @return an {@link Option} containing the organizer or none.
   */
  public Option&lt;String&gt; getOrganizer() {
<span class="nc" id="L251">    return this.getFilterValue(FILTER_ORGANIZERS_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given subject
   *
   * @param subject
   *          the subject to filter for
   */
  public void withSubject(String subject) {
<span class="nc" id="L261">    this.addFilter(createSubjectFilter(Option.option(subject)));</span>
<span class="nc" id="L262">  }</span>

  /**
   * Returns an {@link Option} containing the subject used to filter if set
   *
   * @return an {@link Option} containing the subject or none.
   */
  public Option&lt;String&gt; getSubject() {
<span class="nc" id="L270">    return this.getFilterValue(FILTER_SUBJECT_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given title
   *
   * @param title
   *          the subject to filter for
   */
  public void withTitle(String title) {
<span class="nc" id="L280">    this.addFilter(createTitleFilter(Option.option(title)));</span>
<span class="nc" id="L281">  }</span>

  /**
   * Returns an {@link Option} containing the title used to filter if set
   *
   * @return an {@link Option} containing the title or none.
   */
  public Option&lt;String&gt; getTitle() {
<span class="nc" id="L289">    return this.getFilterValue(FILTER_TITLE_NAME);</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on access policy
   *
   * @param acl
   *          the acl to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for access policy based query
   */
  public static ResourceListFilter&lt;String&gt; createAccessPolicyFilter(Option&lt;String&gt; acl) {
<span class="nc" id="L300">    return FiltersUtils.generateFilter(acl, FILTER_ACL_NAME, FILTER_ACL_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L301">            Option.some(AclListProvider.NAME));</span>
  }

  public static ResourceListFilter&lt;Boolean&gt; createReadPermissionFilter(Option&lt;Boolean&gt; value) {
<span class="nc" id="L305">    return FiltersUtils.generateFilter(value, FILTER_ACL_PERMISSION_READ_NAME, FILTER_ACL_PERMISSION_READ_LABEL,</span>
<span class="nc" id="L306">        SourceType.SELECT, Option.none());</span>
  }

  public static ResourceListFilter&lt;Boolean&gt; createWritePermissionFilter(Option&lt;Boolean&gt; value) {
<span class="nc" id="L310">    return FiltersUtils.generateFilter(value, FILTER_ACL_PERMISSION_WRITE_NAME, FILTER_ACL_PERMISSION_WRITE_LABEL,</span>
<span class="nc" id="L311">        SourceType.SELECT, Option.none());</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a contributor
   *
   * @param contributor
   *          the contributor's name to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a contributor based query
   */
  public static ResourceListFilter&lt;String&gt; createContributorsFilter(Option&lt;String&gt; contributor) {
<span class="fc" id="L322">    return FiltersUtils.generateFilter(contributor, FILTER_CONTRIBUTORS_NAME, FILTER_CONTRIBUTORS_LABEL,</span>
<span class="fc" id="L323">            SourceType.SELECT, Option.some(ContributorsListProvider.DEFAULT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a creator
   *
   * @param creator
   *          the creator to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a creator based query
   */
  public static ResourceListFilter&lt;String&gt; createCreatorFilter(Option&lt;String&gt; creator) {
<span class="nc" id="L334">    return FiltersUtils.generateFilter(creator, FILTER_CREATOR_NAME, FILTER_CREATOR_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L335">            Option.some(ContributorsListProvider.DEFAULT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on creation date period
   *
   * @param period
   *          the period to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for the given period
   */
  public static ResourceListFilter&lt;Tuple&lt;Date, Date&gt;&gt; createCreationDateFilter(Option&lt;Tuple&lt;Date, Date&gt;&gt; period) {
<span class="nc" id="L346">    return FiltersUtils.generateFilter(period, FILTER_CREATIONDATE_NAME, FILTER_CREATIONDATE_LABEL, SourceType.PERIOD,</span>
<span class="nc" id="L347">            Option.none());</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a language
   *
   * @param language
   *          the language to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a language based query
   */
  public static ResourceListFilter&lt;String&gt; createLanguageFilter(Option&lt;String&gt; language) {
<span class="nc" id="L358">    return FiltersUtils.generateFilter(language, FILTER_LANGUAGE_NAME, FILTER_LANGUAGE_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L359">            Option.some(&quot;LANGUAGES&quot;));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a license
   *
   * @param license
   *          the license to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a license based query
   */
  public static ResourceListFilter&lt;String&gt; createLicenseFilter(Option&lt;String&gt; license) {
<span class="nc" id="L370">    return FiltersUtils.generateFilter(license, FILTER_LICENSE_NAME, FILTER_LICENSE_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L371">            Option.some(&quot;LICENSES&quot;));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a organizer
   *
   * @param organizer
   *          the organizer to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a organizer based query
   */
  public static ResourceListFilter&lt;String&gt; createOrganizersFilter(Option&lt;String&gt; organizer) {
<span class="nc" id="L382">    return FiltersUtils.generateFilter(organizer, FILTER_ORGANIZERS_NAME, FILTER_ORGANIZERS_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L383">            Option.some(ContributorsListProvider.DEFAULT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a subject
   *
   * @param subject
   *          the subject to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a subject based query
   */
  public static ResourceListFilter&lt;String&gt; createSubjectFilter(Option&lt;String&gt; subject) {
<span class="nc" id="L394">    return FiltersUtils.generateFilter(subject, FILTER_SUBJECT_NAME, FILTER_SUBJECT_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L395">            Option.some(SeriesListProvider.SUBJECT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a title
   *
   * @param title
   *          the title to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a title based query
   */
  public static ResourceListFilter&lt;String&gt; createTitleFilter(Option&lt;String&gt; title) {
<span class="nc" id="L406">    return FiltersUtils.generateFilter(title, FILTER_TITLE_NAME, FILTER_TITLE_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L407">            Option.some(SeriesListProvider.TITLE));</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>