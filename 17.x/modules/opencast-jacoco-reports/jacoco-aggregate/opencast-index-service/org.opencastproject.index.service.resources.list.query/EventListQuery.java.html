<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>EventListQuery.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-index-service</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.index.service.resources.list.query</a> &gt; <span class="el_source">EventListQuery.java</span></div><h1>EventListQuery.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */

package org.opencastproject.index.service.resources.list.query;

import org.opencastproject.index.service.resources.list.provider.AgentsListProvider;
import org.opencastproject.index.service.resources.list.provider.ContributorsListProvider;
import org.opencastproject.index.service.resources.list.provider.EventsListProvider;
import org.opencastproject.index.service.resources.list.provider.SeriesListProvider;
import org.opencastproject.index.service.util.FiltersUtils;
import org.opencastproject.list.api.ResourceListFilter;
import org.opencastproject.list.api.ResourceListFilter.SourceType;
import org.opencastproject.list.impl.ResourceListQueryImpl;
import org.opencastproject.util.data.Option;
import org.opencastproject.util.data.Tuple;

import java.util.Date;

/**
 * Query for the events list.
 *
 * The following filters can be used:
 * &lt;ul&gt;
 * &lt;li&gt;series&lt;/li&gt;
 * &lt;li&gt;presenters&lt;/li&gt;
 * &lt;li&gt;presenter's usernames&lt;/li&gt;
 * &lt;li&gt;contributors&lt;/li&gt;
 * &lt;li&gt;location&lt;/li&gt;
 * &lt;li&gt;agent&lt;/li&gt;
 * &lt;li&gt;language&lt;/li&gt;
 * &lt;li&gt;startDate&lt;/li&gt;
 * &lt;li&gt;status&lt;/li&gt;
 * &lt;/ul&gt;
 */
public class EventListQuery extends ResourceListQueryImpl {

  public static final String FILTER_SERIES_NAME = &quot;series&quot;;
  private static final String FILTER_SERIES_LABEL = &quot;FILTERS.EVENTS.SERIES.LABEL&quot;;

  public static final String FILTER_PRESENTERS_BIBLIOGRAPHIC_NAME = &quot;presentersBibliographic&quot;;
  private static final String FILTER_PRESENTERS_BIBLIOGRAPHIC_LABEL = &quot;FILTERS.EVENTS.PRESENTERS_BIBLIOGRAPHIC.LABEL&quot;;

  public static final String FILTER_PRESENTERS_TECHNICAL_NAME = &quot;presentersTechnical&quot;;
  private static final String FILTER_PRESENTERS_TECHNICAL_LABEL = &quot;FILTERS.EVENTS.PRESENTERS_TECHNICAL.LABEL&quot;;

  public static final String FILTER_CONTRIBUTORS_NAME = &quot;contributors&quot;;
  private static final String FILTER_CONTRIBUTORS_LABEL = &quot;FILTERS.EVENTS.CONTRIBUTORS.LABEL&quot;;

  public static final String FILTER_LOCATION_NAME = &quot;location&quot;;
  private static final String FILTER_LOCATION_LABEL = &quot;FILTERS.EVENTS.LOCATION.LABEL&quot;;

  public static final String FILTER_AGENT_NAME = &quot;agent&quot;;
  private static final String FILTER_AGENT_LABEL = &quot;FILTERS.EVENTS.AGENT_ID.LABEL&quot;;

  public static final String FILTER_LANGUAGE_NAME = &quot;language&quot;;
  private static final String FILTER_LANGUAGE_LABEL = &quot;FILTERS.EVENTS.LANGUAGE.LABEL&quot;;

  public static final String FILTER_STARTDATE_NAME = &quot;startDate&quot;;
  private static final String FILTER_STARTDATE_LABEL = &quot;FILTERS.EVENTS.START_DATE.LABEL&quot;;

  public static final String FILTER_STATUS_NAME = &quot;status&quot;;
  private static final String FILTER_STATUS_LABEL = &quot;FILTERS.EVENTS.STATUS.LABEL&quot;;

  public static final String FILTER_COMMENTS_NAME = &quot;comments&quot;;
  private static final String FILTER_COMMENTS_LABEL = &quot;FILTERS.EVENTS.COMMENTS.LABEL&quot;;

  public static final String FILTER_PUBLISHER_NAME = &quot;publisher&quot;;
  private static final String FILTER_PUBLISHER_LABEL = &quot;FILTERS.EVENTS.PUBLISHER.LABEL&quot;;

  public static final String FILTER_TEXT_NAME = &quot;textFilter&quot;;

  public static final String FILTER_IS_PUBLISHED_NAME = &quot;isPublished&quot;;
  public static final String FILTER_IS_PUBLISHED_LABEL = &quot;FILTERS.EVENTS.IS_PUBLISHED.LABEL&quot;;

  public EventListQuery() {
<span class="nc" id="L94">    super();</span>
<span class="nc" id="L95">    this.availableFilters.add(createSeriesFilter(Option.none()));</span>
<span class="nc" id="L96">    this.availableFilters.add(createLocationFilter(Option.none()));</span>
<span class="nc" id="L97">    this.availableFilters.add(createAgentFilter(Option.none()));</span>
<span class="nc" id="L98">    this.availableFilters.add(createStartDateFilter(Option.none()));</span>
<span class="nc" id="L99">    this.availableFilters.add(createStatusFilter(Option.none()));</span>
<span class="nc" id="L100">    this.availableFilters.add(createCommentsFilter(Option.none()));</span>
<span class="nc" id="L101">    this.availableFilters.add(createIsPublishedFilter(Option.none()));</span>
<span class="nc" id="L102">  }</span>

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given seriesId
   *
   * @param seriesId
   *          the seriesId to filter with
   */
  public void withSeriesId(String seriesId) {
<span class="nc" id="L111">    this.addFilter(createSeriesFilter(Option.option(seriesId)));</span>
<span class="nc" id="L112">  }</span>

  /**
   * Returns an {@link Option} containing the seriesId used to filter if set
   *
   * @return an {@link Option} containing the seriesId or none.
   */
  public Option&lt;String&gt; getSeriesId() {
<span class="nc" id="L120">    return this.getFilterValue(FILTER_SERIES_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given presenter
   *
   * @param presenter
   *          the presenter to filter for
   */
  public void withPresenter(String presenter) {
<span class="nc" id="L130">    this.addFilter(createPresentersFilter(Option.option(presenter)));</span>
<span class="nc" id="L131">  }</span>

  /**
   * Returns an {@link Option} containing the presenter used to filter if set
   *
   * @return an {@link Option} containing the presenter or none.
   */
  public Option&lt;String&gt; getPresenter() {
<span class="nc" id="L139">    return this.getFilterValue(FILTER_PRESENTERS_BIBLIOGRAPHIC_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given technical presenter's username
   *
   * @param presenter
   *          presenter's username the presenter's username to filter for
   */
  public void withTechnicalPresenter(String presenter) {
<span class="nc" id="L149">    this.addFilter(createTechnicalPresentersFilter(Option.option(presenter)));</span>
<span class="nc" id="L150">  }</span>

  /**
   * Returns an {@link Option} containing the technical presenter's username used to filter if set
   *
   * @return an {@link Option} containing the presenter or none.
   */
  public Option&lt;String&gt; getTechnicalPresenter() {
<span class="nc" id="L158">    return this.getFilterValue(FILTER_PRESENTERS_TECHNICAL_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given contributor
   *
   * @param contributor
   *          the contributor to filter for
   */
  public void withContributor(String contributor) {
<span class="nc" id="L168">    this.addFilter(createContributorsFilter(Option.option(contributor)));</span>
<span class="nc" id="L169">  }</span>

  /**
   * Returns an {@link Option} containing the contributor used to filter if set
   *
   * @return an {@link Option} containing the contributor or none.
   */
  public Option&lt;String&gt; getContributor() {
<span class="nc" id="L177">    return this.getFilterValue(FILTER_CONTRIBUTORS_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given subject
   *
   * @param location
   *          the subject to filter for
   */
  public void withLocation(String location) {
<span class="nc" id="L187">    this.addFilter(createLocationFilter(Option.option(location)));</span>
<span class="nc" id="L188">  }</span>

  /**
   * Returns an {@link Option} containing the location used to filter if set
   *
   * @return an {@link Option} containing the location or none.
   */
  public Option&lt;String&gt; getLocation() {
<span class="nc" id="L196">    return this.getFilterValue(FILTER_LOCATION_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given subject
   *
   * @param agent
   *          the agent to filter for
   */
  public void withAgent(String agent) {
<span class="nc" id="L206">    this.addFilter(createAgentFilter(Option.option(agent)));</span>
<span class="nc" id="L207">  }</span>

  /**
   * Returns an {@link Option} containing the agent used to filter if set
   *
   * @return an {@link Option} containing the agent or none.
   */
  public Option&lt;String&gt; getAgent() {
<span class="nc" id="L215">    return this.getFilterValue(FILTER_AGENT_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given subject
   *
   * @param language
   *          the subject to filter for
   */
  public void withLanguage(String language) {
<span class="nc" id="L225">    this.addFilter(createLanguageFilter(Option.option(language)));</span>
<span class="nc" id="L226">  }</span>

  /**
   * Returns an {@link Option} containing the language used to filter if set
   *
   * @return an {@link Option} containing the language or none.
   */
  public Option&lt;String&gt; getLanguage() {
<span class="nc" id="L234">    return this.getFilterValue(FILTER_LANGUAGE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given start date period
   *
   * @param startDate
   *          the start date period as {@link Tuple} with two {@link Date}.
   */
  public void withStartDate(Tuple&lt;Date, Date&gt; startDate) {
<span class="nc" id="L244">    this.addFilter(createStartDateFilter(Option.option(startDate)));</span>
<span class="nc" id="L245">  }</span>

  /**
   * Returns an {@link Option} containing the start date period used to filter if set
   *
   * @return an {@link Option} containing the start date period or none.
   */
  public Option&lt;Tuple&lt;Date, Date&gt;&gt; getStartDate() {
<span class="nc" id="L253">    return this.getFilterValue(FILTER_STARTDATE_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given status
   *
   * @param status
   *          the status to filter for
   */
  public void withStatus(String status) {
<span class="nc" id="L263">    this.addFilter(createStatusFilter(Option.option(status)));</span>
<span class="nc" id="L264">  }</span>

  /**
   * Returns an {@link Option} containing the status used to filter if set
   *
   * @return an {@link Option} containing the status or none.
   */
  public Option&lt;String&gt; getStatus() {
<span class="nc" id="L272">    return this.getFilterValue(FILTER_STATUS_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given comments
   *
   * @param comments
   *          the comments to filter for
   */
  public void withComments(String comments) {
<span class="nc" id="L282">    this.addFilter(createCommentsFilter(Option.option(comments)));</span>
<span class="nc" id="L283">  }</span>

  /**
   * Returns an {@link Option} containing the comments used to filter if set
   *
   * @return an {@link Option} containing the comments or none.
   */
  public Option&lt;String&gt; getComments() {
<span class="nc" id="L291">    return this.getFilterValue(FILTER_COMMENTS_NAME);</span>
  }

  /**
   * Add a {@link ResourceListFilter} filter to the query with the given publishers
   *
   * @param publishers
   *          the publishers to filter for
   */
  public void withPublishers(String publishers) {
<span class="nc" id="L301">    this.addFilter(createPublisherFilter(Option.option(publishers)));</span>
<span class="nc" id="L302">  }</span>

  /**
   * Returns an {@link Option} containing the publisher used to filter if set
   *
   * @return an {@link Option} containing the publisher or none.
   */
  public Option&lt;String&gt; getPublisher() {
<span class="nc" id="L310">    return this.getFilterValue(FILTER_PUBLISHER_NAME);</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on the Series id
   *
   * @param seriesId
   *          the series id to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for the Series name based query
   */
  public static ResourceListFilter&lt;String&gt; createSeriesFilter(Option&lt;String&gt; seriesId) {
<span class="nc" id="L321">    return FiltersUtils.generateFilter(seriesId, FILTER_SERIES_NAME, FILTER_SERIES_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L322">            Option.some(SeriesListProvider.PROVIDER_PREFIX));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a presenter's full name
   *
   * @param presenter's
   *          name the presenters to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a presenters based query
   */
  public static ResourceListFilter&lt;String&gt; createPresentersFilter(Option&lt;String&gt; presenter) {
<span class="nc" id="L333">    return FiltersUtils.generateFilter(presenter, FILTER_PRESENTERS_BIBLIOGRAPHIC_NAME,</span>
<span class="nc" id="L334">            FILTER_PRESENTERS_BIBLIOGRAPHIC_LABEL, SourceType.SELECT, Option.some(ContributorsListProvider.DEFAULT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a presenter's user name
   *
   * @param presenter
   *          the presenters to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a presenters based query
   */
  public static ResourceListFilter&lt;String&gt; createTechnicalPresentersFilter(Option&lt;String&gt; presenter) {
<span class="nc" id="L345">    return FiltersUtils.generateFilter(presenter, FILTER_PRESENTERS_TECHNICAL_NAME, FILTER_PRESENTERS_TECHNICAL_LABEL,</span>
<span class="nc" id="L346">            SourceType.SELECT, Option.some(ContributorsListProvider.USERNAMES));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a contributor
   *
   * @param contributor
   *          the series id to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a contributor based query
   */
  public static ResourceListFilter&lt;String&gt; createContributorsFilter(Option&lt;String&gt; contributor) {
<span class="nc" id="L357">    return FiltersUtils.generateFilter(contributor, FILTER_CONTRIBUTORS_NAME, FILTER_CONTRIBUTORS_LABEL,</span>
<span class="nc" id="L358">            SourceType.SELECT, Option.some(ContributorsListProvider.DEFAULT));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a location
   *
   * @param location
   *          the location to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a location based query
   */
  public static ResourceListFilter&lt;String&gt; createLocationFilter(Option&lt;String&gt; location) {
<span class="nc" id="L369">    return FiltersUtils.generateFilter(location, FILTER_LOCATION_NAME, FILTER_LOCATION_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L370">            Option.some(EventsListProvider.LOCATION));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on an agent
   *
   * @param agent
   *          the agent to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a location based query
   */
  public static ResourceListFilter&lt;String&gt; createAgentFilter(Option&lt;String&gt; agent) {
<span class="nc" id="L381">    return FiltersUtils.generateFilter(agent, FILTER_AGENT_NAME, FILTER_AGENT_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L382">            Option.some(AgentsListProvider.NAME));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on a language
   *
   * @param language
   *          the language to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for a language based query
   */
  public static ResourceListFilter&lt;String&gt; createLanguageFilter(Option&lt;String&gt; language) {
<span class="nc" id="L393">    return FiltersUtils.generateFilter(language, FILTER_LANGUAGE_NAME, FILTER_LANGUAGE_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L394">            Option.some(&quot;LANGUAGES&quot;));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on start date period
   *
   * @param period
   *          the period to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for the given period
   */
  public static ResourceListFilter&lt;Tuple&lt;Date, Date&gt;&gt; createStartDateFilter(Option&lt;Tuple&lt;Date, Date&gt;&gt; period) {
<span class="nc" id="L405">    return FiltersUtils.generateFilter(period, FILTER_STARTDATE_NAME, FILTER_STARTDATE_LABEL, SourceType.PERIOD,</span>
<span class="nc" id="L406">            Option.none());</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on stats
   *
   * @param status
   *          the status to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for progress based query
   */
  public static ResourceListFilter&lt;String&gt; createStatusFilter(Option&lt;String&gt; status) {
<span class="nc" id="L417">    return FiltersUtils.generateFilter(status, FILTER_STATUS_NAME, FILTER_STATUS_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L418">            Option.some(EventsListProvider.STATUS));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on comments
   *
   * @param comments
   *          the comments to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for progress based query
   */
  public static ResourceListFilter&lt;String&gt; createCommentsFilter(Option&lt;String&gt; comments) {
<span class="nc" id="L429">    return FiltersUtils.generateFilter(comments, FILTER_COMMENTS_NAME, FILTER_COMMENTS_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L430">            Option.some(EventsListProvider.COMMENTS));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on publishers
   *
   * @param publisher
   *          the publisher to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for progress based query
   */
  public static ResourceListFilter&lt;String&gt; createPublisherFilter(Option&lt;String&gt; publisher) {
<span class="nc" id="L441">    return FiltersUtils.generateFilter(publisher, FILTER_PUBLISHER_NAME, FILTER_PUBLISHER_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L442">            Option.some(EventsListProvider.PUBLISHER));</span>
  }

  /**
   * Create a new {@link ResourceListFilter} based on is published
   * @param isPublished
   *          the is published status to filter on wrapped in an {@link Option} or {@link Option#none()}
   * @return a new {@link ResourceListFilter} for progress based query
   */
  public static ResourceListFilter&lt;String&gt; createIsPublishedFilter(Option&lt;String&gt; isPublished) {
<span class="nc" id="L452">    return FiltersUtils.generateFilter(isPublished, FILTER_IS_PUBLISHED_NAME, FILTER_IS_PUBLISHED_LABEL, SourceType.SELECT,</span>
<span class="nc" id="L453">        Option.some(EventsListProvider.ISPUBLISHED));</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>