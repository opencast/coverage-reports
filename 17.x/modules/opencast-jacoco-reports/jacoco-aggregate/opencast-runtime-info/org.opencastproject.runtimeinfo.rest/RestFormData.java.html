<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>RestFormData.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-runtime-info</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.runtimeinfo.rest</a> &gt; <span class="el_source">RestFormData.java</span></div><h1>RestFormData.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */

package org.opencastproject.runtimeinfo.rest;

import java.util.ArrayList;
import java.util.List;

public class RestFormData {

  /**
   * This indicates whether the form submission should be an ajax submit or a normal submit.
   */
<span class="nc" id="L32">  private boolean ajaxSubmit = false;</span>

  /**
   * If this is true then the upload contains a body parameter (i.e. a file upload option).
   */
<span class="nc" id="L37">  private boolean fileUpload = false;</span>

  /**
   * This indicates whether this test form is for a basic endpoint which has no parameters.
   */
<span class="nc" id="L42">  private boolean basic = false;</span>

  /**
   * The form parameters.
   */
  private List&lt;RestParamData&gt; items;

  /**
   * Constructor which will auto-populate the form using the data in the endpoint, this will enable the ajax submit if
   * it is possible to do so.
   *
   * @param endpoint
   *          a RestEndpointData object populated with all parameters it needs
   * @throws IllegalArgumentException
   *           when endpoint is null
   */
<span class="nc" id="L58">  public RestFormData(RestEndpointData endpoint) throws IllegalArgumentException {</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">    if (endpoint == null) {</span>
<span class="nc" id="L60">      throw new IllegalArgumentException(&quot;Endpoint must not be null.&quot;);</span>
    }
<span class="nc" id="L62">    ajaxSubmit = true;</span>
<span class="nc" id="L63">    items = new ArrayList&lt;RestParamData&gt;(3);</span>
<span class="nc" id="L64">    boolean hasUpload = false;</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">    if (endpoint.getPathParams() != null) {</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">      for (RestParamData param : endpoint.getPathParams()) {</span>
<span class="nc" id="L67">        param.setRequired(true);</span>
<span class="nc" id="L68">        items.add(param);</span>
<span class="nc" id="L69">      }</span>
    }
<span class="nc bnc" id="L71" title="All 2 branches missed.">    if (endpoint.getRequiredParams() != null) {</span>
<span class="nc bnc" id="L72" title="All 2 branches missed.">      for (RestParamData param : endpoint.getRequiredParams()) {</span>
<span class="nc" id="L73">        param.setRequired(true);</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        if (RestParamData.Type.FILE.name().equalsIgnoreCase(param.getType())) {</span>
<span class="nc" id="L75">          hasUpload = true;</span>
        }
<span class="nc" id="L77">        items.add(param);</span>
<span class="nc" id="L78">      }</span>
    }
<span class="nc bnc" id="L80" title="All 2 branches missed.">    if (endpoint.getOptionalParams() != null) {</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">      for (RestParamData param : endpoint.getOptionalParams()) {</span>
<span class="nc" id="L82">        param.setRequired(false);</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (RestParamData.Type.FILE.name().equalsIgnoreCase(param.getType())) {</span>
<span class="nc" id="L84">          hasUpload = true;</span>
        }
<span class="nc" id="L86">        items.add(param);</span>
<span class="nc" id="L87">      }</span>
    }
<span class="nc bnc" id="L89" title="All 2 branches missed.">    if (endpoint.getBodyParam() != null) {</span>
<span class="nc" id="L90">      RestParamData param = endpoint.getBodyParam();</span>
<span class="nc" id="L91">      param.setRequired(true);</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">      if (RestParamData.Type.FILE.name().equalsIgnoreCase(param.getType())) {</span>
<span class="nc" id="L93">        hasUpload = true;</span>
      }
<span class="nc" id="L95">      items.add(param);</span>
    }
<span class="nc bnc" id="L97" title="All 2 branches missed.">    if (hasUpload) {</span>
<span class="nc" id="L98">      fileUpload = true;</span>
<span class="nc" id="L99">      ajaxSubmit = false;</span>
    }
<span class="nc bnc" id="L101" title="All 4 branches missed.">    if (items.isEmpty() &amp;&amp; endpoint.isGetMethod()) {</span>
<span class="nc" id="L102">      basic = true;</span>
    }
<span class="nc" id="L104">  }</span>

  /**
   * Returns true if this form has no parameter in it, false if there is parameter in it.
   *
   * @return a boolean indicating whether this form contains any parameter
   */
  public boolean isEmpty() {
<span class="nc" id="L112">    boolean empty = true;</span>
<span class="nc bnc" id="L113" title="All 4 branches missed.">    if (items != null &amp;&amp; !items.isEmpty()) {</span>
<span class="nc" id="L114">      empty = false;</span>
    }
<span class="nc" id="L116">    return empty;</span>
  }

  /**
   * Controls whether the form will be submitted via ajax and the content rendered on the page, NOTE that uploading any
   * files or downloading any content that is binary will require not using ajax submit, also note that there may be
   * other cases where ajax submission will fail to work OR where normal submission will fail to work (using PUT/DELETE)
   *
   * @param ajaxSubmit
   *          a boolean indicating whether ajax submit is used
   */
  public void setAjaxSubmit(boolean ajaxSubmit) {
<span class="nc" id="L128">    this.ajaxSubmit = ajaxSubmit;</span>
<span class="nc" id="L129">  }</span>

  /**
   * Set this to true if the file contains a file upload control, this will be determined automatically for
   * auto-generated forms.
   *
   * @param fileUpload
   *          a boolean indicating whether there is file upload in this test
   */
  public void setFileUpload(boolean fileUpload) {
<span class="nc" id="L139">    this.fileUpload = fileUpload;</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">    if (fileUpload) {</span>
<span class="nc" id="L141">      ajaxSubmit = false;</span>
    }
<span class="nc" id="L143">  }</span>

  /**
   * Returns a string representation of this form.
   *
   * @return a string representation of this form
   */
  @Override
  public String toString() {
<span class="nc bnc" id="L152" title="All 2 branches missed.">    if (items == null) {</span>
<span class="nc" id="L153">      return &quot;FORM:items=0&quot;;</span>
    }
<span class="nc" id="L155">    return &quot;FORM:items=&quot; + items.size();</span>
  }

  /**
   * Returns whether the form submission should be an ajax submission or a normal submission.
   *
   * @return a boolean indicating whether the form submission should be an ajax submission or a normal submission
   */
  public boolean isAjaxSubmit() {
<span class="nc" id="L164">    return ajaxSubmit;</span>
  }

  /**
   * Returns whether the form contains a body parameter (i.e. a file upload option).
   *
   * @return a boolean indicating whether the form contains a body parameter (i.e. a file upload option)
   */
  public boolean isFileUpload() {
<span class="nc" id="L173">    return fileUpload;</span>
  }

  /**
   * Returns whether this form is for a basic endpoint which has no parameters.
   *
   * @return a boolean indicating whether this form is for a basic endpoint which has no parameters
   */
  public boolean isBasic() {
<span class="nc" id="L182">    return basic;</span>
  }

  /**
   * Returns the list of form parameters.
   *
   * @return a list of form parameters
   */
  public List&lt;RestParamData&gt; getItems() {
<span class="nc" id="L191">    return items;</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>