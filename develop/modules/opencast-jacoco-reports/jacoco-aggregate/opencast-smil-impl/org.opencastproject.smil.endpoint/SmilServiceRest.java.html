<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>SmilServiceRest.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-smil-impl</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.smil.endpoint</a> &gt; <span class="el_source">SmilServiceRest.java</span></div><h1>SmilServiceRest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */

package org.opencastproject.smil.endpoint;

import org.opencastproject.mediapackage.MediaPackage;
import org.opencastproject.mediapackage.MediaPackageElementParser;
import org.opencastproject.mediapackage.MediaPackageException;
import org.opencastproject.mediapackage.MediaPackageParser;
import org.opencastproject.mediapackage.Track;
import org.opencastproject.smil.api.SmilException;
import org.opencastproject.smil.api.SmilResponse;
import org.opencastproject.smil.api.SmilService;
import org.opencastproject.util.doc.rest.RestParameter;
import org.opencastproject.util.doc.rest.RestQuery;
import org.opencastproject.util.doc.rest.RestResponse;
import org.opencastproject.util.doc.rest.RestService;

import org.osgi.service.component.annotations.Component;
import org.osgi.service.component.annotations.Reference;
import org.osgi.service.jaxrs.whiteboard.propertytypes.JaxrsResource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.List;

import javax.servlet.http.HttpServletResponse;
import javax.ws.rs.FormParam;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

/**
 * Implement {@link SmilService} as REST Endpoint.
 */
@Path(&quot;/smil&quot;)
@RestService(
    name = &quot;smil&quot;,
    title = &quot;SmilService Rest Endpoint&quot;,
    abstractText = &quot;SmilRestService provide other services to create and modify Smil objects.&quot;,
    notes = {
        &quot;All paths above are relative to the REST endpoint base (something like http://your.server/smil)&quot;
    }
)
@Component(
    property = {
        &quot;service.description=Smil Service REST Endpoint&quot;,
        &quot;opencast.service.type=org.opencastproject.smil&quot;,
        &quot;opencast.service.path=/smil&quot;
    },
    immediate = true,
    service = { SmilServiceRest.class }
)
@JaxrsResource
<span class="nc" id="L75">public class SmilServiceRest {</span>

  /**
   * Logger
   */
<span class="nc" id="L80">  private static final Logger logger = LoggerFactory.getLogger(SmilServiceRest.class);</span>

  /**
   * SmilService to interact with
   */
  private SmilService smilService;

  @POST
  @Path(&quot;create&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;create&quot;,
      description = &quot;Create new SMIL. Add some MediaPackage metadata.&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;mediaPackage&quot;,
              description = &quot;MediaPackage for metadata.&quot;,
              isRequired = false,
              type = RestParameter.Type.TEXT
          ),
      },
      returnDescription = &quot;Returns new SmilResponse with SMIL document inside.&quot;,
      responses = {
          @RestResponse(
            responseCode = HttpServletResponse.SC_OK,
            description = &quot;Create new SMIL successfull&quot;
          ),
          @RestResponse(
            responseCode = HttpServletResponse.SC_BAD_REQUEST,
            description = &quot;Given mediaPackage is not valid&quot;
          ),
      }
  )
  public Response createNewSmil(@FormParam(&quot;mediaPackage&quot;) String mediaPackage) {
<span class="nc" id="L114">    SmilResponse smilResponse = null;</span>
    try {
<span class="nc bnc" id="L116" title="All 4 branches missed.">      if (mediaPackage != null &amp;&amp; !mediaPackage.isEmpty()) {</span>
<span class="nc" id="L117">        MediaPackage mp = MediaPackageParser.getFromXml(mediaPackage);</span>
<span class="nc" id="L118">        smilResponse = smilService.createNewSmil(mp);</span>
<span class="nc" id="L119">      } else {</span>
<span class="nc" id="L120">        smilResponse = smilService.createNewSmil();</span>
      }

<span class="nc" id="L123">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L124">    } catch (MediaPackageException ex) {</span>
<span class="nc" id="L125">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L126">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;MediaPackage not valid.&quot;).build();</span>
    }
  }

  @POST
  @Path(&quot;addPar&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;addPar&quot;,
      description = &quot;Add an parallel element to SMIL (into SMIL body or an element with given parentId).&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document where to add a par-element.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;parentId&quot;,
              description = &quot;An element Id, were to add new parallel.&quot;,
              isRequired = false,
              type = RestParameter.Type.STRING
          )
      },
      returnDescription = &quot;Returns SmilResponse with a parallel element inside &quot;
          + &quot;(the new par will be returned as response entity).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Add par to SMIL successfull.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document doesn't contain an element with given parentId.&quot;
          ),
      }
  )
  public Response addParallel(@FormParam(&quot;smil&quot;) String smil, @FormParam(&quot;parentId&quot;) String parentId) {
<span class="nc" id="L168">    SmilResponse smilResponse = null;</span>
    try {
<span class="nc" id="L170">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L171">    } catch (SmilException ex) {</span>
<span class="nc" id="L172">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
<span class="nc" id="L173">    }</span>

    try {
<span class="nc bnc" id="L176" title="All 4 branches missed.">      if (parentId != null &amp;&amp; !parentId.isEmpty()) {</span>
<span class="nc" id="L177">        smilResponse = smilService.addParallel(smilResponse.getSmil(), parentId);</span>
      } else {
<span class="nc" id="L179">        smilResponse = smilService.addParallel(smilResponse.getSmil());</span>
      }
<span class="nc" id="L181">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L182">    } catch (SmilException ex) {</span>
<span class="nc" id="L183">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L184">      return Response.status(HttpServletResponse.SC_BAD_REQUEST)</span>
<span class="nc" id="L185">          .entity(&quot;SMIL document doesn't contain an element with given parentId.&quot;)</span>
<span class="nc" id="L186">          .build();</span>
    }
  }

  @POST
  @Path(&quot;addSeq&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;addSeq&quot;,
      description = &quot;Add an sequence element to SMIL (into SMIL body or an element with given parentId).&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document where to add a seq-element.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;parentId&quot;,
              description = &quot;An element Id, were to add new sequence.&quot;,
              isRequired = false,
              type = RestParameter.Type.STRING
          )
      },
      returnDescription = &quot;Returns SmilResponse with a sequence element inside &quot;
          + &quot;(the new seq will be returned as response entity).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Add seq to SMIL successfull&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document doesn't contain an element with given parentId&quot;
          ),
      }
  )
  public Response addSequence(@FormParam(&quot;smil&quot;) String smil, @FormParam(&quot;parentId&quot;) String parentId) {
<span class="nc" id="L228">    SmilResponse smilResponse = null;</span>
    try {
<span class="nc" id="L230">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L231">    } catch (SmilException ex) {</span>
<span class="nc" id="L232">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L233">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
<span class="nc" id="L234">    }</span>

    try {
<span class="nc bnc" id="L237" title="All 4 branches missed.">      if (parentId != null &amp;&amp; !parentId.isEmpty()) {</span>
<span class="nc" id="L238">        smilResponse = smilService.addSequence(smilResponse.getSmil(), parentId);</span>
      } else {
<span class="nc" id="L240">        smilResponse = smilService.addSequence(smilResponse.getSmil());</span>
      }
<span class="nc" id="L242">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L243">    } catch (SmilException ex) {</span>
<span class="nc" id="L244">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L245">      return Response.status(HttpServletResponse.SC_BAD_REQUEST)</span>
<span class="nc" id="L246">          .entity(&quot;SMIL document doesn't contain an element with given parentId.&quot;)</span>
<span class="nc" id="L247">          .build();</span>
    }
  }

  @POST
  @Path(&quot;addClip&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;addClip&quot;,
      description = &quot;Add new media element based on given Track information and start / duration parameters. &quot;
          + &quot;ParentId specifies where to put the new media element.&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document where to add new media element.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;parentId&quot;,
              description = &quot;An element Id, were to add new media.&quot;,
              isRequired = false,
              type = RestParameter.Type.STRING
          ),
          @RestParameter(
              name = &quot;track&quot;,
              description = &quot;Track (MediaPackageElement) to add as media element. &quot;
                  + &quot;Some information like Track source and flavor will be stored in ParamGroup (in SMIL Head) &quot;
                  + &quot;and referenced by paramGroup media element attribute.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;start&quot;,
              description = &quot;Track start position in milliseconds.&quot;,
              isRequired = true,
              type = RestParameter.Type.INTEGER
          ),
          @RestParameter(
              name = &quot;duration&quot;,
              description = &quot;Clip duration in milliseconds (should be positive).&quot;,
              isRequired = true,
              type = RestParameter.Type.INTEGER
          ),
      },
      returnDescription = &quot;Returns new Smil with an media element inside &quot;
          + &quot;(the new media and metadata elements will be returned as response entities).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Add media element to SMIL successfull.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;Track not valid.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document doesn't contain an element with given parentId.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;Start plus duration is bigger than Track length.&quot;
          ),
      }
  )
  public Response addClip(
      @FormParam(&quot;smil&quot;) String smil,
      @FormParam(&quot;parentId&quot;) String parentId,
      @FormParam(&quot;track&quot;) String track,
      @FormParam(&quot;start&quot;) long start,
      @FormParam(&quot;duration&quot;) long duration
  ) {
<span class="nc" id="L324">    SmilResponse smilResponse = null;</span>
<span class="nc" id="L325">    Track trackObj = null;</span>
    try {
<span class="nc" id="L327">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L328">      trackObj = (Track) MediaPackageElementParser.getFromXml(track);</span>
<span class="nc" id="L329">    } catch (SmilException ex) {</span>
<span class="nc" id="L330">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
<span class="nc" id="L331">    } catch (MediaPackageException ex) {</span>
<span class="nc" id="L332">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;Track is not valid.&quot;).build();</span>
<span class="nc" id="L333">    }</span>
    try {
<span class="nc" id="L335">      smilResponse = smilService.addClip(smilResponse.getSmil(), parentId, trackObj, start, duration);</span>
<span class="nc" id="L336">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L337">    } catch (SmilException ex) {</span>
<span class="nc" id="L338">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L339">      return Response.status(HttpServletResponse.SC_BAD_REQUEST)</span>
<span class="nc" id="L340">          .entity(&quot;SMIL document doesn't contain an element with given parentId.&quot;)</span>
<span class="nc" id="L341">          .build();</span>
    }
  }

  @POST
  @Path(&quot;addClips&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;addClips&quot;,
      description = &quot;Add new media elements based on given Tracks information and start / duration parameters. &quot;
          + &quot;ParentId specifies where to put the new media.&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document where to add new media elements.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;parentId&quot;,
              description = &quot;An element Id, were to add new media. &quot;,
              isRequired = false,
              type = RestParameter.Type.STRING
          ),
          @RestParameter(
              name = &quot;tracks&quot;,
              description = &quot;Tracks (MediaPackageElements) to add as media elements.&quot;
                  + &quot;Some information like Track source and flavor will be stored in ParamGroup (in SMIL Head) &quot;
                  + &quot;and referenced by paramGroup media element attribute.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;start&quot;,
              description = &quot;Track start position in milliseconds. &quot;
                  + &quot;The start position will be applied to each media element.&quot;,
              isRequired = true,
              type = RestParameter.Type.INTEGER
          ),
          @RestParameter(
              name = &quot;duration&quot;,
              description = &quot;Clip duration in milliseconds (should be positive). &quot;
                  + &quot;The duration will be applied to each media element.&quot;,
              isRequired = true,
              type = RestParameter.Type.INTEGER
          ),
      },
      returnDescription = &quot;Returns new Smil with new media elements inside &quot;
          + &quot;(the new media and metadata elements will be returned as response entities).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Add media elements to SMIL successfull.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;Tracks are not valid.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document doesn't contain an element with given parentId.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;Start plus duration is bigger than Track length.&quot;
          ),
      }
  )
  public Response addClips(
      @FormParam(&quot;smil&quot;) String smil,
      @FormParam(&quot;parentId&quot;) String parentId,
      @FormParam(&quot;tracks&quot;) String tracks,
      @FormParam(&quot;start&quot;) long start,
      @FormParam(&quot;duration&quot;) long duration
  ) {
<span class="nc" id="L420">    SmilResponse smilResponse = null;</span>
<span class="nc" id="L421">    List&lt;Track&gt; tracksList = null;</span>
    try {
<span class="nc" id="L423">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L424">      tracksList = (List&lt;Track&gt;) MediaPackageElementParser.getArrayFromXml(tracks);</span>
<span class="nc" id="L425">    } catch (SmilException ex) {</span>
<span class="nc" id="L426">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L427">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
<span class="nc" id="L428">    } catch (MediaPackageException ex) {</span>
<span class="nc" id="L429">      logger.error(ex.getMessage(), ex);</span>
<span class="nc" id="L430">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;Tracks are not valid.&quot;).build();</span>
<span class="nc" id="L431">    }</span>

<span class="nc" id="L433">    Track[] tracksArr = tracksList.toArray(new Track[tracksList.size()]);</span>
    try {
<span class="nc" id="L435">      smilResponse = smilService.addClips(smilResponse.getSmil(), parentId, tracksArr, start, duration);</span>
<span class="nc" id="L436">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L437">    } catch (SmilException ex) {</span>
<span class="nc" id="L438">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L439">      return Response.status(HttpServletResponse.SC_BAD_REQUEST)</span>
<span class="nc" id="L440">          .entity(&quot;SMIL document doesn't contain an element with given parentId.&quot;)</span>
<span class="nc" id="L441">          .build();</span>
    }
  }

  @POST
  @Path(&quot;addMeta&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;addMeta&quot;,
      description = &quot;Add a meta element to SMIL head.&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document where to add an meta element.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;name&quot;,
              description = &quot;Value of meta name attribute.&quot;,
              isRequired = true,
              type = RestParameter.Type.STRING
          ),
          @RestParameter(
              name = &quot;content&quot;,
              description = &quot;Value of meta content attribute.&quot;,
              isRequired = true,
              type = RestParameter.Type.STRING
          ),
      },
      returnDescription = &quot;Returns SmilResponse with a new meta element inside &quot;
          + &quot;(the new meta will be returned as response entity).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Add par to SMIL successfull.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid.&quot;
          ),
      }
  )
  public Response addMeta(
      @FormParam(&quot;smil&quot;) String smil,
      @FormParam(&quot;name&quot;) String metaName,
      @FormParam(&quot;content&quot;) String metaContent
  ) {
<span class="nc" id="L489">    SmilResponse smilResponse = null;</span>
    try {
<span class="nc" id="L491">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L492">    } catch (SmilException ex) {</span>
<span class="nc" id="L493">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
<span class="nc" id="L494">    }</span>
<span class="nc" id="L495">    smilResponse = smilService.addMeta(smilResponse.getSmil(), metaName, metaContent);</span>
<span class="nc" id="L496">    return Response.ok(smilResponse).build();</span>
  }

  @POST
  @Path(&quot;remove&quot;)
  @Produces({MediaType.APPLICATION_XML, MediaType.TEXT_XML})
  @RestQuery(
      name = &quot;remove&quot;,
      description = &quot;Remove an element with given Id from SMIL.&quot;,
      restParameters = {
          @RestParameter(
              name = &quot;smil&quot;,
              description = &quot;SMIL document.&quot;,
              isRequired = true,
              type = RestParameter.Type.TEXT
          ),
          @RestParameter(
              name = &quot;elementId&quot;,
              description = &quot;Id of element to remove.&quot;,
              isRequired = true,
              type = RestParameter.Type.STRING
          )
      },
      returnDescription = &quot;Returns SMIL document without an element with given Id &quot;
          + &quot;(if SMIL document contains an element with given Id, this will be returned as entity).&quot;,
      responses = {
          @RestResponse(
              responseCode = HttpServletResponse.SC_OK,
              description = &quot;Removing element from SMIL successfull.&quot;
          ),
          @RestResponse(
              responseCode = HttpServletResponse.SC_BAD_REQUEST,
              description = &quot;SMIL document not valid.&quot;
          ),
      }
  )
  public Response removeSmilElement(@FormParam(&quot;smil&quot;) String smil, @FormParam(&quot;elementId&quot;) String elementId) {
<span class="nc" id="L533">    SmilResponse smilResponse = null;</span>
    try {
<span class="nc" id="L535">      smilResponse = smilService.fromXml(smil);</span>
<span class="nc" id="L536">      smilResponse = smilService.removeSmilElement(smilResponse.getSmil(), elementId);</span>
<span class="nc" id="L537">      return Response.ok(smilResponse).build();</span>
<span class="nc" id="L538">    } catch (SmilException ex) {</span>
<span class="nc" id="L539">      logger.info(ex.getMessage(), ex);</span>
<span class="nc" id="L540">      return Response.status(HttpServletResponse.SC_BAD_REQUEST).entity(&quot;SMIL document invalid.&quot;).build();</span>
    }
  }

  /**
   * Set {@link SmilService}.
   *
   * @param smilService {@link SmilService} to set
   */
  @Reference
  public void setSmilService(SmilService smilService) {
<span class="nc" id="L551">    this.smilService = smilService;</span>
<span class="nc" id="L552">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>