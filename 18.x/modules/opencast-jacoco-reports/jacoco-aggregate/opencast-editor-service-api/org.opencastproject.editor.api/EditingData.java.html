<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>EditingData.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-editor-service-api</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.editor.api</a> &gt; <span class="el_source">EditingData.java</span></div><h1>EditingData.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */
package org.opencastproject.editor.api;

import static java.util.Objects.requireNonNull;

import org.opencastproject.security.api.User;
import org.opencastproject.util.data.Tuple;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.annotations.SerializedName;

import java.util.Collections;
import java.util.List;
import java.util.UUID;

/**
 * Provides access to the parsed editing information
 */
public class EditingData {
  public static final String WORKFLOW_ACTIVE = &quot;workflow_active&quot;;
  public static final String LOCKING_ACTIVE = &quot;locking_active&quot;;
  public static final String LOCK_REFRESH = &quot;lock_refresh&quot;;
  public static final String LOCK_UUID = &quot;lock_uuid&quot;;
  public static final String LOCK_USER = &quot;lock_user&quot;;
  private final List&lt;SegmentData&gt; segments;
  private final List&lt;WorkflowData&gt; workflows;
  private final List&lt;TrackData&gt; tracks;
  private final String title;
  private final String date;
  private final Long duration;
  private final SeriesData series;
  @SerializedName(WORKFLOW_ACTIVE)
  private final Boolean workflowActive;
  @SerializedName(LOCKING_ACTIVE)
  private final Boolean lockingActive;
  @SerializedName(LOCK_REFRESH)
  private final Integer lockRefresh;
  @SerializedName(LOCK_UUID)
  private final String lockUUID;
  @SerializedName(LOCK_USER)
  private final String lockUser;

  private final List&lt;String&gt; waveformURIs;
  private final List&lt;Subtitle&gt; subtitles;
  private final Boolean local;

  private final String metadataJSON;

  public EditingData(List&lt;SegmentData&gt; segments, List&lt;TrackData&gt; tracks, List&lt;WorkflowData&gt; workflows, Long duration,
          String title, String recordingStartDate, String seriesId, String seriesName, Boolean workflowActive,
          List&lt;String&gt; waveformURIs, List&lt;Subtitle&gt; subtitles, Boolean local, Boolean lockingActive,
<span class="nc" id="L72">          Integer lockRefresh, User user, String metadataJSON) {</span>
<span class="nc" id="L73">    this.segments = segments;</span>
<span class="nc" id="L74">    this.tracks = tracks;</span>
<span class="nc" id="L75">    this.workflows = workflows;</span>
<span class="nc" id="L76">    this.duration = duration;</span>
<span class="nc" id="L77">    this.title = title;</span>
<span class="nc" id="L78">    this.date = recordingStartDate;</span>
<span class="nc" id="L79">    this.series = new SeriesData(seriesId, seriesName);</span>
<span class="nc" id="L80">    this.workflowActive = workflowActive;</span>
<span class="nc" id="L81">    this.waveformURIs = waveformURIs;</span>
<span class="nc" id="L82">    this.subtitles = subtitles;</span>
<span class="nc" id="L83">    this.local = local;</span>
<span class="nc" id="L84">    this.lockingActive = lockingActive;</span>
<span class="nc" id="L85">    this.lockRefresh = lockRefresh * 1000;</span>
<span class="nc" id="L86">    this.lockUUID = UUID.randomUUID().toString();</span>
<span class="nc" id="L87">    this.lockUser = user.getUsername();</span>
<span class="nc" id="L88">    this.metadataJSON = metadataJSON;</span>
<span class="nc" id="L89">  }</span>

  public static EditingData parse(String json) {
<span class="fc" id="L92">    requireNonNull(json);</span>
<span class="fc" id="L93">    Gson gson = new Gson();</span>
<span class="fc" id="L94">    EditingData editingData = gson.fromJson(json, EditingData.class);</span>
<span class="fc" id="L95">    requireNonNull(editingData.getTracks());</span>
<span class="fc" id="L96">    requireNonNull(editingData.getSegments());</span>

<span class="fc" id="L98">    return editingData;</span>
  }

  /**
   * Returns a list of {@link Tuple} that each represents a segment. {@link Tuple#getA()} marks the start point,
   * {@link Tuple#getB()} the endpoint of the segement.
   */
  public List&lt;SegmentData&gt; getSegments() {
<span class="fc" id="L106">    return Collections.unmodifiableList(segments);</span>
  }

   /**
   * Returns the optional workflow to start
   */
  public String getPostProcessingWorkflow() {
<span class="pc bpc" id="L113" title="1 of 4 branches missed.">    return (workflows != null &amp;&amp; workflows.size() &gt; 0) ? workflows.get(0).getId() : null;</span>
  }

  public List&lt;TrackData&gt; getTracks() {
<span class="fc" id="L117">    return Collections.unmodifiableList(tracks);</span>
  }

  public List&lt;Subtitle&gt; getSubtitles() {
<span class="nc" id="L121">    return subtitles;</span>
  }

  public String getMetadataJSON() {
<span class="nc" id="L125">    return metadataJSON;</span>
  }

  public String toString() {
<span class="fc" id="L129">    Gson gson = new GsonBuilder().serializeNulls().create();</span>
<span class="fc" id="L130">    return gson.toJson(this);</span>
  }

  public static final class Subtitle {
    private final String id;
    /** content of the subtitle */
    private final String subtitle;
    private final String[] tags;
    private final boolean deleted;

    public Subtitle(String id, String subtitle, String[] tags) {
<span class="nc" id="L141">      this(id, subtitle, tags,false);</span>
<span class="nc" id="L142">    }</span>

<span class="nc" id="L144">    public Subtitle(String id, String subtitle, String[] tags, boolean deleted) {</span>
<span class="nc" id="L145">      this.id = id;</span>
<span class="nc" id="L146">      this.subtitle = subtitle;</span>
<span class="nc" id="L147">      this.tags = tags;</span>
<span class="nc" id="L148">      this.deleted = deleted;</span>
<span class="nc" id="L149">    }</span>

    public String getId() {
<span class="nc" id="L152">      return id;</span>
    }

    public String getSubtitle() {
<span class="nc" id="L156">      return subtitle;</span>
    }

    public String[] getTags() {
<span class="nc" id="L160">      return tags;</span>
    }

    public boolean isDeleted() {
<span class="nc" id="L164">      return deleted;</span>
    }

  }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>