<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>OpencastDctermsDublinCore.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Opencast :: jacoco-reports</a> &gt; <a href="../index.html" class="el_bundle">opencast-dublincore</a> &gt; <a href="index.source.html" class="el_package">org.opencastproject.metadata.dublincore</a> &gt; <span class="el_source">OpencastDctermsDublinCore.java</span></div><h1>OpencastDctermsDublinCore.java</h1><pre class="source lang-java linenums">/*
 * Licensed to The Apereo Foundation under one or more contributor license
 * agreements. See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 *
 * The Apereo Foundation licenses this file to you under the Educational
 * Community License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License
 * at:
 *
 *   http://opensource.org/licenses/ecl2.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 */
package org.opencastproject.metadata.dublincore;

import static com.entwinemedia.fn.Stream.$;
import static org.opencastproject.metadata.dublincore.DublinCore.LANGUAGE_ANY;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_AUDIENCE;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_CONTRIBUTOR;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_CREATED;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_CREATOR;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_DESCRIPTION;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_EXTENT;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_IDENTIFIER;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_ISSUED;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_IS_PART_OF;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_LANGUAGE;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_LICENSE;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_PUBLISHER;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_RIGHTS_HOLDER;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_SOURCE;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_SPATIAL;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_TEMPORAL;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_TITLE;
import static org.opencastproject.metadata.dublincore.DublinCore.PROPERTY_TYPE;

import org.opencastproject.mediapackage.EName;
import org.opencastproject.metadata.dublincore.Temporal.Match;

import com.entwinemedia.fn.Fn;
import com.entwinemedia.fn.Stream;
import com.entwinemedia.fn.Unit;
import com.entwinemedia.fn.data.Opt;
import com.entwinemedia.fn.fns.Strings;

import org.apache.commons.lang3.StringUtils;

import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.MissingResourceException;

import javax.annotation.Nonnull;
import javax.annotation.ParametersAreNonnullByDefault;

/**
 * {@link DublinCoreCatalog} wrapper to deal with DublinCore metadata according to the Opencast schema.
 * &lt;p&gt;
 * &lt;h2&gt;General behaviour&lt;/h2&gt;
 * &lt;ul&gt;
 * &lt;li&gt;Set methods that take a string parameter only execute if the string is not blank.
 * &lt;li&gt;Set methods that take a list of strings only execute if the list contains at least one non-blank string.
 * &lt;li&gt;Set methods--if executed--replace the whole property with the given value/s.
 * &lt;li&gt;Update methods only execute if the parameter is some non-blank string. If executed they
 * behave like a set method and replace all exiting entries.
 * &lt;li&gt;Add methods only execute if the parameter is some non-blank string.
 * &lt;/ul&gt;
 */
@ParametersAreNonnullByDefault
public abstract class OpencastDctermsDublinCore {
  protected final DublinCoreCatalog dc;

<span class="fc" id="L80">  private OpencastDctermsDublinCore(DublinCoreCatalog dc) {</span>
<span class="fc" id="L81">    this.dc = dc;</span>
<span class="fc" id="L82">  }</span>

  /** Return the wrapped catalog. */
  public DublinCoreCatalog getCatalog() {
<span class="fc" id="L86">    return dc;</span>
  }

  /* ------------------------------------------------------------------------------------------------------------------ */

  @Nonnull public List&lt;String&gt; getPublishers() {
<span class="nc" id="L92">    return get(PROPERTY_PUBLISHER);</span>
  }

  public void setPublishers(List&lt;String&gt; publishers) {
<span class="nc" id="L96">    set(PROPERTY_PUBLISHER, publishers);</span>
<span class="nc" id="L97">  }</span>

  public void addPublisher(String publisher) {
<span class="nc" id="L100">    add(PROPERTY_PUBLISHER, publisher);</span>
<span class="nc" id="L101">  }</span>

  public void removePublishers() {
<span class="nc" id="L104">    dc.remove(PROPERTY_PUBLISHER);</span>
<span class="nc" id="L105">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  @Nonnull public List&lt;String&gt; getRightsHolders() {
<span class="nc" id="L110">    return get(PROPERTY_RIGHTS_HOLDER);</span>
  }

  public void setRightsHolders(List&lt;String&gt; rightsHolders) {
<span class="nc" id="L114">    set(PROPERTY_RIGHTS_HOLDER, rightsHolders);</span>
<span class="nc" id="L115">  }</span>

  public void addRightsHolder(String rightsHolder) {
<span class="nc" id="L118">    add(PROPERTY_RIGHTS_HOLDER, rightsHolder);</span>
<span class="nc" id="L119">  }</span>

  public void removeRightsHolders() {
<span class="nc" id="L122">    dc.remove(PROPERTY_RIGHTS_HOLDER);</span>
<span class="nc" id="L123">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  @Nonnull public Opt&lt;String&gt; getLicense() {
<span class="nc" id="L128">    return getFirst(PROPERTY_LICENSE);</span>
  }

  public void setLicense(String license) {
<span class="nc" id="L132">    set(PROPERTY_LICENSE, license);</span>
<span class="nc" id="L133">  }</span>

  public void removeLicense() {
<span class="nc" id="L136">    dc.remove(PROPERTY_LICENSE);</span>
<span class="nc" id="L137">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_IDENTIFIER} property. */
  @Nonnull public Opt&lt;String&gt; getDcIdentifier() {
<span class="fc" id="L143">    return getFirst(PROPERTY_IDENTIFIER);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_IDENTIFIER} property. */
  public void setDcIdentifier(String id) {
<span class="nc" id="L148">    set(PROPERTY_IDENTIFIER, id);</span>
<span class="nc" id="L149">  }</span>

  /** Update the {@link DublinCore#PROPERTY_IDENTIFIER} property. */
  public void updateDcIdentifier(Opt&lt;String&gt; id) {
<span class="nc" id="L153">    update(PROPERTY_IDENTIFIER, id);</span>
<span class="nc" id="L154">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_IDENTIFIER} property. */
  public void removeDcIdentifier() {
<span class="nc" id="L158">    dc.remove(PROPERTY_IDENTIFIER);</span>
<span class="nc" id="L159">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_TITLE} property. */
  @Nonnull public Opt&lt;String&gt; getTitle() {
<span class="nc" id="L165">    return getFirst(PROPERTY_TITLE);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_TITLE} property. */
  public void setTitle(String title) {
<span class="nc" id="L170">    set(PROPERTY_TITLE, title);</span>
<span class="nc" id="L171">  }</span>

  /** Update the {@link DublinCore#PROPERTY_TITLE} property. */
  public void updateTitle(Opt&lt;String&gt; title) {
<span class="nc" id="L175">    update(PROPERTY_TITLE, title);</span>
<span class="nc" id="L176">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_TITLE} property. */
  public void removeTitle() {
<span class="nc" id="L180">    dc.remove(PROPERTY_TITLE);</span>
<span class="nc" id="L181">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_DESCRIPTION} property. */
  @Nonnull public Opt&lt;String&gt; getDescription() {
<span class="nc" id="L187">    return getFirst(PROPERTY_DESCRIPTION);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_DESCRIPTION} property. */
  public void setDescription(String description) {
<span class="nc" id="L192">    set(PROPERTY_DESCRIPTION, description);</span>
<span class="nc" id="L193">  }</span>

  /** Update the {@link DublinCore#PROPERTY_DESCRIPTION} property. */
  public void updateDescription(Opt&lt;String&gt; description) {
<span class="nc" id="L197">    update(PROPERTY_DESCRIPTION, description);</span>
<span class="nc" id="L198">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_DESCRIPTION} property. */
  public void removeDescription() {
<span class="nc" id="L202">    dc.remove(PROPERTY_DESCRIPTION);</span>
<span class="nc" id="L203">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get all {@link DublinCore#PROPERTY_AUDIENCE} properties. */
  @Nonnull public List&lt;String&gt; getAudiences() {
<span class="nc" id="L209">    return get(PROPERTY_AUDIENCE);</span>
  }

  /** Set multiple {@link DublinCore#PROPERTY_AUDIENCE} properties. */
  public void setAudiences(List&lt;String&gt; audiences) {
<span class="nc" id="L214">    set(PROPERTY_AUDIENCE, audiences);</span>
<span class="nc" id="L215">  }</span>

  /** Set the {@link DublinCore#PROPERTY_AUDIENCE} property. */
  public void setAudience(String audience) {
<span class="nc" id="L219">    set(PROPERTY_AUDIENCE, audience);</span>
<span class="nc" id="L220">  }</span>

  /** Add an {@link DublinCore#PROPERTY_AUDIENCE} property. */
  public void addAudience(String audience) {
<span class="nc" id="L224">    add(PROPERTY_AUDIENCE, audience);</span>
<span class="nc" id="L225">  }</span>

  /** Update the {@link DublinCore#PROPERTY_AUDIENCE} property. */
  public void updateAudience(Opt&lt;String&gt; audience) {
<span class="nc" id="L229">    update(PROPERTY_AUDIENCE, audience);</span>
<span class="nc" id="L230">  }</span>

  /** Remove all {@link DublinCore#PROPERTY_AUDIENCE} properties. */
  public void removeAudiences() {
<span class="nc" id="L234">    dc.remove(PROPERTY_AUDIENCE);</span>
<span class="nc" id="L235">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_CREATED} property. */
  @Nonnull public Opt&lt;Temporal&gt; getCreated() {
<span class="nc" id="L241">    return getFirstVal(PROPERTY_CREATED).map(OpencastMetadataCodec.decodeTemporal);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_CREATED} property. The date is encoded with a precision of {@link Precision#Day}. */
  public void setCreated(Date date) {
    // only allow to set a created date, if no start date is set. Otherwise DC created will be changed by changing the
    // start date with setTemporal. Synchronization is not vice versa, as setting DC created to arbitraty dates might
    // have unwanted side effects, like setting the wrong recording time, on imported data, or third-party REST calls.
<span class="nc bnc" id="L249" title="All 2 branches missed.">    if (getTemporal().isNone()) {</span>
<span class="nc" id="L250">      setDate(PROPERTY_CREATED, date, Precision.Day);</span>
    }
<span class="nc" id="L252">  }</span>

  /** Set the {@link DublinCore#PROPERTY_CREATED} property. The date is encoded with a precision of {@link Precision#Day}. */
  public void setCreated(Temporal t) {
    // only allow to set a created date, if no start date is set. Otherwise DC created will be changed by changing the
    // start date with setTemporal. Synchronization is not vice versa, as setting DC created to arbitraty dates might
    // have unwanted side effects, like setting the wrong recording time, on imported data, or third-party REST calls.
<span class="nc bnc" id="L259" title="All 2 branches missed.">    if (getTemporal().isNone()) {</span>
<span class="nc" id="L260">      t.fold(new Match&lt;Unit&gt;() {</span>
        @Override public Unit period(DCMIPeriod period) {
<span class="nc" id="L262">          setCreated(period.getStart());</span>
<span class="nc" id="L263">          return Unit.unit;</span>
        }

        @Override public Unit instant(Date instant) {
<span class="nc" id="L267">          setCreated(instant);</span>
<span class="nc" id="L268">          return Unit.unit;</span>
        }

        @Override public Unit duration(long duration) {
<span class="nc" id="L272">          return Unit.unit;</span>
        }
      });
    }
<span class="nc" id="L276">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_CREATED} property. */
  public void removeCreated() {
<span class="nc" id="L280">    dc.remove(PROPERTY_CREATED);</span>
<span class="nc" id="L281">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get all {@link DublinCore#PROPERTY_CREATOR} properties. */
  @Nonnull public List&lt;String&gt; getCreators() {
<span class="nc" id="L287">    return get(PROPERTY_CREATOR);</span>
  }

  /** Set multiple {@link DublinCore#PROPERTY_CREATOR} properties. */
  public void setCreators(List&lt;String&gt; creators) {
<span class="nc" id="L292">    set(PROPERTY_CREATOR, creators);</span>
<span class="nc" id="L293">  }</span>

  /** Set the {@link DublinCore#PROPERTY_CREATOR} property. */
  public void setCreator(String creator) {
<span class="nc" id="L297">    set(PROPERTY_CREATOR, creator);</span>
<span class="nc" id="L298">  }</span>

  /** Add a {@link DublinCore#PROPERTY_CREATOR} property. */
  public void addCreator(String name) {
<span class="nc" id="L302">    add(PROPERTY_CREATOR, name);</span>
<span class="nc" id="L303">  }</span>

  /** Update the {@link DublinCore#PROPERTY_CREATOR} property. */
  public void updateCreator(Opt&lt;String&gt; name) {
<span class="nc" id="L307">    update(PROPERTY_CREATOR, name);</span>
<span class="nc" id="L308">  }</span>

  /** Remove all {@link DublinCore#PROPERTY_CREATOR} properties. */
  public void removeCreators() {
<span class="nc" id="L312">    dc.remove(PROPERTY_CREATOR);</span>
<span class="nc" id="L313">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_EXTENT} property. */
  @Nonnull public Opt&lt;Long&gt; getExtent() {
<span class="nc" id="L319">    return getFirst(PROPERTY_EXTENT).map(OpencastMetadataCodec.decodeDuration);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_EXTENT} property. */
  public void setExtent(Long extent) {
<span class="nc" id="L324">    dc.set(PROPERTY_EXTENT, OpencastMetadataCodec.encodeDuration(extent));</span>
<span class="nc" id="L325">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_EXTENT} property. */
  public void removeExtent() {
<span class="nc" id="L329">    dc.remove(PROPERTY_EXTENT);</span>
<span class="nc" id="L330">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_ISSUED} property. */
  @Nonnull public Opt&lt;Date&gt; getIssued() {
<span class="nc" id="L336">    return getFirst(PROPERTY_ISSUED).map(OpencastMetadataCodec.decodeDate);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_ISSUED} property. */
  public void setIssued(Date date) {
<span class="nc" id="L341">    setDate(PROPERTY_ISSUED, date, Precision.Day);</span>
<span class="nc" id="L342">  }</span>

  /** Update the {@link DublinCore#PROPERTY_ISSUED} property. */
  public void updateIssued(Opt&lt;Date&gt; date) {
<span class="nc" id="L346">    updateDate(PROPERTY_ISSUED, date, Precision.Day);</span>
<span class="nc" id="L347">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_ISSUED} property. */
  public void removeIssued() {
<span class="nc" id="L351">    dc.remove(PROPERTY_ISSUED);</span>
<span class="nc" id="L352">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_LANGUAGE} property. */
  @Nonnull public Opt&lt;String&gt; getLanguage() {
<span class="nc" id="L358">    return getFirst(PROPERTY_LANGUAGE);</span>
  }

  /**
   * Set the {@link DublinCore#PROPERTY_LANGUAGE} property.
   * A 2- or 3-letter ISO code. 2-letter ISO codes are tried to convert into a 3-letter code.
   * If this is not possible the provided string is used as is.
   */
  public void setLanguage(String lang) {
<span class="nc bnc" id="L367" title="All 2 branches missed.">    if (StringUtils.isNotBlank(lang)) {</span>
<span class="nc" id="L368">      String doLang = lang;</span>
<span class="nc bnc" id="L369" title="All 2 branches missed.">      if (lang.length() == 2) {</span>
        try {
<span class="nc" id="L371">          doLang = new Locale(lang).getISO3Language();</span>
<span class="nc" id="L372">        } catch (MissingResourceException ignore) {</span>
<span class="nc" id="L373">        }</span>
      }
<span class="nc" id="L375">      set(PROPERTY_LANGUAGE, doLang);</span>
    }
<span class="nc" id="L377">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_LANGUAGE} property. */
  public void removeLanguage() {
<span class="nc" id="L381">    dc.remove(PROPERTY_LANGUAGE);</span>
<span class="nc" id="L382">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_SPATIAL} property. */
  @Nonnull public Opt&lt;String&gt; getSpatial() {
<span class="nc" id="L388">    return getFirst(PROPERTY_SPATIAL);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_SPATIAL} property. */
  public void setSpatial(String spatial) {
<span class="nc" id="L393">    set(PROPERTY_SPATIAL, spatial);</span>
<span class="nc" id="L394">  }</span>

  /** Update the {@link DublinCore#PROPERTY_SPATIAL} property. */
  public void updateSpatial(Opt&lt;String&gt; spatial) {
<span class="nc" id="L398">    update(PROPERTY_SPATIAL, spatial);</span>
<span class="nc" id="L399">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_SPATIAL} property. */
  public void removeSpatial() {
<span class="nc" id="L403">    dc.remove(PROPERTY_SPATIAL);</span>
<span class="nc" id="L404">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_SOURCE} property. */
  @Nonnull public Opt&lt;String&gt; getSource() {
<span class="nc" id="L410">    return getFirst(PROPERTY_SOURCE);</span>
  }

  /** Set the {@link DublinCore#PROPERTY_SOURCE} property. */
  public void setSource(String source) {
<span class="nc" id="L415">    set(PROPERTY_SOURCE, source);</span>
<span class="nc" id="L416">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_SOURCE} property. */
  public void removeSource() {
<span class="nc" id="L420">    dc.remove(PROPERTY_SOURCE);</span>
<span class="nc" id="L421">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get all {@link DublinCore#PROPERTY_CONTRIBUTOR} properties. */
  @Nonnull public List&lt;String&gt; getContributors() {
<span class="nc" id="L427">    return get(PROPERTY_CONTRIBUTOR);</span>
  }

  /** Set multiple {@link DublinCore#PROPERTY_CONTRIBUTOR} properties. */
  public void setContributors(List&lt;String&gt; contributors) {
<span class="nc" id="L432">    set(PROPERTY_CONTRIBUTOR, contributors);</span>
<span class="nc" id="L433">  }</span>

  /** Set the {@link DublinCore#PROPERTY_CONTRIBUTOR} property. */
  public void setContributor(String contributor) {
<span class="nc" id="L437">    set(PROPERTY_CONTRIBUTOR, contributor);</span>
<span class="nc" id="L438">  }</span>

  /** Add a {@link DublinCore#PROPERTY_CONTRIBUTOR} property. */
  public void addContributor(String contributor) {
<span class="nc" id="L442">    add(PROPERTY_CONTRIBUTOR, contributor);</span>
<span class="nc" id="L443">  }</span>

  /** Update the {@link DublinCore#PROPERTY_CONTRIBUTOR} property. */
  public void updateContributor(Opt&lt;String&gt; contributor) {
<span class="nc" id="L447">    update(PROPERTY_CONTRIBUTOR, contributor);</span>
<span class="nc" id="L448">  }</span>

  /** Remove all {@link DublinCore#PROPERTY_CONTRIBUTOR} properties. */
  public void removeContributors() {
<span class="nc" id="L452">    dc.remove(PROPERTY_CONTRIBUTOR);</span>
<span class="nc" id="L453">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_TEMPORAL} property. */
  @Nonnull public Opt&lt;Temporal&gt; getTemporal() {
<span class="nc" id="L459">    return getFirstVal(PROPERTY_TEMPORAL).map(OpencastMetadataCodec.decodeTemporal);</span>
  }

  /**
   * Set the {@link DublinCore#PROPERTY_TEMPORAL} property.
   * The dates are encoded with a precision of {@link Precision#Second}.
   */
  public void setTemporal(Date from, Date to) {
<span class="nc" id="L467">    setPeriod(PROPERTY_TEMPORAL, from, to, Precision.Second);</span>

    // make sure that DC created is synchronized with start date, as discussed in MH-12250
<span class="nc" id="L470">    setDate(PROPERTY_CREATED, from, Precision.Day);</span>
<span class="nc" id="L471">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_TEMPORAL} property. */
  public void removeTemporal() {
<span class="nc" id="L475">    dc.remove(PROPERTY_TEMPORAL);</span>
<span class="nc" id="L476">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  /** Get the {@link DublinCore#PROPERTY_TYPE} property split into its components. Components are separated by &quot;/&quot;. */
  @Nonnull public Opt&lt;Stream&lt;String&gt;&gt; getType() {
<span class="nc" id="L482">    return getFirst(PROPERTY_TYPE).map(Strings.split(&quot;/&quot;));</span>
  }

  /** Get the {@link DublinCore#PROPERTY_TYPE} property as a single string. */
  @Nonnull public Opt&lt;String&gt; getTypeCombined() {
<span class="nc" id="L487">    return getFirst(PROPERTY_TYPE);</span>
  }

  /**
   * Set the {@link DublinCore#PROPERTY_TYPE} property from a type and a subtype.
   * Type and subtype are separated by &quot;/&quot;.
   */
  public void setType(String type, String subtype) {
<span class="nc" id="L495">    set(PROPERTY_TYPE, type + &quot;/&quot; + subtype);</span>
<span class="nc" id="L496">  }</span>

  /** Set the {@link DublinCore#PROPERTY_TYPE} property from a single string. */
  public void setType(String type) {
<span class="nc" id="L500">    set(PROPERTY_TYPE, type);</span>
<span class="nc" id="L501">  }</span>

  /** Remove the {@link DublinCore#PROPERTY_TYPE} property. */
  public void removeType() {
<span class="nc" id="L505">    dc.remove(PROPERTY_TYPE);</span>
<span class="nc" id="L506">  }</span>

  /* ------------------------------------------------------------------------------------------------------------------ */

  public static final class Episode extends OpencastDctermsDublinCore {

    public Episode(DublinCoreCatalog dc) {
<span class="fc" id="L513">      super(dc);</span>
<span class="fc" id="L514">    }</span>

    /** Get the {@link DublinCore#PROPERTY_IS_PART_OF} property. */
    @Nonnull public Opt&lt;String&gt; getIsPartOf() {
<span class="nc" id="L518">      return getFirst(PROPERTY_IS_PART_OF);</span>
    }

    /** Set the {@link DublinCore#PROPERTY_IS_PART_OF} property. */
    public void setIsPartOf(String seriesID) {
<span class="nc" id="L523">      set(PROPERTY_IS_PART_OF, seriesID);</span>
<span class="nc" id="L524">    }</span>

    /** Update the {@link DublinCore#PROPERTY_IS_PART_OF} property. */
    public void updateIsPartOf(Opt&lt;String&gt; seriesID) {
<span class="nc" id="L528">      update(PROPERTY_IS_PART_OF, seriesID);</span>
<span class="nc" id="L529">    }</span>

    /** Remove the {@link DublinCore#PROPERTY_IS_PART_OF} property. */
    public void removeIsPartOf() {
<span class="nc" id="L533">      dc.remove(PROPERTY_IS_PART_OF);</span>
<span class="nc" id="L534">    }</span>

  }

  /* ------------------------------------------------------------------------------------------------------------------ */

  public static final class Series extends OpencastDctermsDublinCore {
    public Series(DublinCoreCatalog dc) {
<span class="fc" id="L542">      super(dc);</span>
<span class="fc" id="L543">    }</span>
  }

  /* ------------------------------------------------------------------------------------------------------------------ */

  protected void setDate(EName property, Date date, Precision p) {
<span class="nc" id="L549">    dc.set(property, OpencastMetadataCodec.encodeDate(date, p));</span>
<span class="nc" id="L550">  }</span>

  protected void updateDate(EName property, Opt&lt;Date&gt; date, Precision p) {
<span class="nc bnc" id="L553" title="All 2 branches missed.">    for (Date d : date) {</span>
<span class="nc" id="L554">      setDate(property, d, p);</span>
<span class="nc" id="L555">    }</span>
<span class="nc" id="L556">  }</span>

  /** Encode with {@link Precision#Second}. */
  protected void setPeriod(EName property, Date from, Date to, Precision p) {
<span class="nc" id="L560">    dc.set(property, OpencastMetadataCodec.encodePeriod(from, to, p));</span>
<span class="nc" id="L561">  }</span>

  protected List&lt;String&gt; get(EName property) {
<span class="nc" id="L564">    return dc.get(property, LANGUAGE_ANY);</span>
  }

  /** Like {@link DublinCore#getFirst(EName)} but with the result wrapped in an Opt. */
  protected Opt&lt;String&gt; getFirst(EName property) {
<span class="fc" id="L569">    return Opt.nul(dc.getFirst(property));</span>
  }

  /** Like {@link DublinCore#getFirstVal(EName)} but with the result wrapped in an Opt. */
  protected Opt&lt;DublinCoreValue&gt; getFirstVal(EName property) {
<span class="nc" id="L574">    return Opt.nul(dc.getFirstVal(property));</span>
  }

  public void set(EName property, String value) {
<span class="nc bnc" id="L578" title="All 2 branches missed.">    if (StringUtils.isNotBlank(value)) {</span>
<span class="nc" id="L579">      dc.set(property, value);</span>
    }
<span class="nc" id="L581">  }</span>

  public void set(EName property, List&lt;String&gt; values) {
<span class="nc" id="L584">    final List&lt;DublinCoreValue&gt; valuesFiltered = $(values).filter(Strings.isNotBlank).map(mkValue).toList();</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">    if (!valuesFiltered.isEmpty()) {</span>
<span class="nc" id="L586">      dc.remove(property);</span>
<span class="nc" id="L587">      dc.set(property, valuesFiltered);</span>
    }
<span class="nc" id="L589">  }</span>

  protected void add(EName property, String value) {
<span class="nc bnc" id="L592" title="All 2 branches missed.">    if (StringUtils.isNotBlank(value)) {</span>
<span class="nc" id="L593">      dc.add(property, value);</span>
    }
<span class="nc" id="L595">  }</span>

  protected void update(EName property, Opt&lt;String&gt; value) {
<span class="nc bnc" id="L598" title="All 2 branches missed.">    for (String v : value) {</span>
<span class="nc" id="L599">      set(property, v);</span>
<span class="nc" id="L600">    }</span>
<span class="nc" id="L601">  }</span>

<span class="fc" id="L603">  private final Fn&lt;String, DublinCoreValue&gt; mkValue = new Fn&lt;String, DublinCoreValue&gt;() {</span>
    @Override public DublinCoreValue apply(String v) {
<span class="nc" id="L605">      return DublinCoreValue.mk(v);</span>
    }
  };
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>